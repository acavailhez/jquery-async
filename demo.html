<!doctype html>
<html lang="en">
<head>
    <title>jQuery Async</title>

    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Jquery-async : jQuery plugin to animate buttons when an asynchronous process is waiting to complete (ajax, etc.)" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">


    <link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet">
    <link href="http://twitter.github.com/bootstrap/assets/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="http://twitter.github.com/bootstrap/assets/css/bootstrap-responsive.css" rel="stylesheet">
    <script src="http://code.jquery.com/jquery-1.9.0.min.js"></script>

    <script src="js/jquery.loader.js"></script>
    <script src="js/jquery.async.js"></script>

</head>
<body>

<!-- HEADER -->
<div id="header_wrap" class="outer">
    <header class="inner">
        <a id="forkme_banner" href="https://github.com/acavailhez/jquery-async">View on GitHub</a>

        <h1 id="project_title">Jquery-async</h1>
        <h2 id="project_tagline">jQuery plugin to animate buttons when an asynchronous process is waiting to complete (ajax, etc.)</h2>

        <section id="downloads">
            <a class="zip_download_link" href="https://github.com/acavailhez/jquery-async/zipball/master">Download this project as a .zip file</a>
            <a class="tar_download_link" href="https://github.com/acavailhez/jquery-async/tarball/master">Download this project as a tar.gz file</a>
        </section>
    </header>
</div>

<!-- MAIN CONTENT -->
<div id="main_content_wrap" class="outer">
    <section id="main_content" class="inner">

        <br/>
        <br/>

        <h1 style="text-align: center;">jQuery Async Demo</h1>
        <p style="text-align: right"><a href="http://github.com/acavailhez/jquery-async">Project page &raquo;</a></p>

        <br/>
        <br/>
        <br/>

        <h3>Asynchronous user action</h3>

        <a id="button1" class="btn btn-info"> Test asynchronous user action</a>
        <script>
            $('#button1').async(function(deferred){

                $('#button1-buttons').show();

                $('#button1-done').click(function(){
                    deferred.resolve();
                    $('#button1-buttons').hide();
                });
                $('#button1-fail').click(function(){
                    deferred.reject();
                    $('#button1-buttons').hide();
                });
            });

        </script>
            <span id="button1-buttons" style="display:none;">
                <a id="button1-done" class="btn btn-success" >Action done</a>
                <a id="button1-fail" class="btn btn-danger">Action failed</a>
            </span>


        <br/>
        <br/>
        <br/>

        <h3>Ajax button</h3>
        <p>jquery-async can link directly ajax options to a button, with the added possibility to pass a function to the url param.</p>
        <input type="text" id="input2" placeholder="Type a US postal code, eg:94114" style="margin-bottom:0;width:240px"/>
        <a id="button2" class="btn btn-info" loading-text="Requesting"> Get temperature</a>
        <span id="temperature"></span>
        <script>

            $('#button2').async('ajax',{
                type: 'POST',
                dataType:'jsonp',
                url: function(deferred){
                    //construct the url from the input, returns the url, or false if error
                    var postal = $('#input2').val();
                    if(!postal || !$.isNumeric(postal)){
                        $('#temperature').html('Please enter a postal code');
                        return false;
                    }
                    else{
                        var yql = encodeURIComponent('select item from weather.forecast where location="' + postal +'"');
                        return 'http://query.yahooapis.com/v1/public/yql?q=' + yql + '&format=json';
                    }
                },
                success:function(json,deferred){
                    if(json.query.results.channel.item.condition){
                        $('#temperature').html(json.query.results.channel.item.condition.temp+'°F');
                        deferred.resolve();
                    }
                    else{
                        $('#temperature').html(json.query.results.channel.item.title);
                        deferred.reject();
                    }
                }
            });

        </script>

        <br/>
        <br/>
        <br/>

        <h3>Params embedded in HTML attributes</h3>
        <p>Buttons with an async-function attributes will automatically be converted to asynchronous buttons</p>

        <a async-function="asyncFunctionTest" async-params="{timeout:1500}" class="btn btn-info"> Test embedded params</a>
        <a async-bind="mouseenter" async-function="asyncFunctionTest" async-params="globalObject.values" class="btn btn-info"> Test embedded params 2</a>
        <script>
            function asyncFunctionTest(deferred,params){
                setTimeout(function(){
                    deferred.resolve();
                },params.timeout);
            };

            var globalObject = {
                values:{
                    timeout:1000
                }
            }

        </script>

        <br/>
        <br/>
        <br/>

        <h3>Handling params in Ajax calls</h3>

        <p>Construct your API urls more easily by passing url params as a JSON object (or a function returning JSON)</p>
        <input type="text" id="input4" placeholder="Type a US postal code, eg:94114" style="margin-bottom:0;width:240px"/>
        <a id="button4" class="btn btn-info" loading-text="Requesting"> Get temperature</a>
        <span id="temperature4"></span>
        <script>

            $('#button4').async('ajax',{
                type: 'POST',
                dataType:'jsonp',
                root:'http://query.yahooapis.com/$version/public/yql',
                params:function(deferred){
                    //construct the url from the input, returns the url, or false if error
                    var postal = $('#input4').val();
                    if(!postal || !$.isNumeric(postal)){
                        $('#temperature4').html('Please enter a postal code');
                        return false;
                    }
                    else{
                        var yql = encodeURIComponent('select item from weather.forecast where location="' + postal +'"');
                        return {
                            version:'v1',
                            q:yql,
                            format:'json'
                        };
                    }
                },
                success:function(json,deferred){
                    if(json.query.results.channel.item.condition){
                        $('#temperature4').html(json.query.results.channel.item.condition.temp+'°F');
                        deferred.resolve();
                    }
                    else{
                        $('#temperature4').html(json.query.results.channel.item.title);
                        deferred.reject();
                    }
                }
            });

        </script>

        <br/>
        <br/>
        <br/>

        <p>POST data can also be automatically parsed from a JSON object (or a function returning JSON)</p>
        <input type="text" id="input5" placeholder="Type a US postal code, eg:94114" style="margin-bottom:0;width:240px"/>
        <a id="button5" class="btn btn-info" loading-text="Requesting"> Get temperature</a>
        <span id="temperature5"></span>
        <script>

            $('#button5').async('ajax',{
                type: 'POST',
                dataType:'jsonp',
                root:'http://query.yahooapis.com/v1/public/yql',
                data:function(deferred){
                    //construct the url from the input, returns the url, or false if error
                    var postal = $('#input5').val();
                    if(!postal || !$.isNumeric(postal)){
                        $('#temperature5').html('Please enter a postal code');
                        return false;
                    }
                    else{
                        var yql = 'select item from weather.forecast where location="' + postal +'"';
                        return {
                            q:yql,
                            format:'json'
                        };
                    }
                },
                success:function(json,deferred){
                    if(json.query.results.channel.item.condition){
                        $('#temperature5').html(json.query.results.channel.item.condition.temp+'°F');
                        deferred.resolve();
                    }
                    else{
                        $('#temperature5').html(json.query.results.channel.item.title);
                        deferred.reject();
                    }
                }
            });

        </script>


        <br/>
        <br/>
        <br/>

        <br/>
        <br/>
        <br/>

    </section>
</div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
    <footer class="inner">
        <p class="copyright">Jquery-async maintained by <a href="https://github.com/acavailhez">acavailhez</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
    </footer>
</div>


</body>
</html>
